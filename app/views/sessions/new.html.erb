<h2>
  <center>Welcome!</center>
</h2>
<div class="container">
    	<div class="row">
			<div class="col-md-6 col-md-offset-3">
				<div class="panel panel-login">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-6">
								<a href="#" class="active" id="login-form-link">Login</a>
							</div>
							<div class="col-xs-6">
								<a href="#" id="register-form-link">Register</a>
							</div>
						</div>
						<hr>
					</div>
					<div class="panel-body">
						<div class="row">
							<div class="col-lg-12">
								<form id="login-form" style="display: block;">
									<div class="form-group">
										<input type="email" name="email" id="email" tabindex="1" class="form-control" placeholder="Email" value="">
									</div>
									<div class="form-group">
										<input type="password" name="password" id="password" tabindex="2" class="form-control" placeholder="Password">
									</div>
									<div class="form-group">
										<div class="row">
											<div class="col-sm-6 col-sm-offset-3">
                      <center><input type='button' class="btn btn-info" name="login-button" id="login-button" onClick='logIn()' tabindex="4" value='Log In'></center>
											</div>
										</div>
									</div>
								</form>
								<form id="register-form" style="display: none;">
									<div class="form-group">
										<input type="text" name="first_name" id="first_name" tabindex="1" class="form-control" placeholder="First name" value="">
                  </div>
                  <div class="form-group">
                    <input type="text" name="last_name" id="last_name" tabindex="1" class="form-control" placeholder="Last name" value="">
                  </div>
									<div class="form-group">
										<input type="email" name="email" id="email" tabindex="1" class="form-control" placeholder="Email Address" value="">
									</div>
									<div class="form-group">
										<input type="password" name="password" id="password" tabindex="2" class="form-control" placeholder="Password">
									</div>
									<div class="form-group">
										<div class="row">
											<div class="col-sm-6 col-sm-offset-3">
												<center><input type='button' class="btn btn-info" name="register-submit" id="register-submit" onClick='Register()' tabindex="4" value='Register'></center>
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
          </div>
          <div class='row'>
            <center><div id='login-errors'></div></center>
          </div>
				</div>
			</div>
		</div>
	</div>

	<script>
  $(function() {

    $('#login-form-link').click(function(e) {
		$("#login-form").delay(100).fadeIn(100);
 		$("#register-form").fadeOut(100);
		$('#register-form-link').removeClass('active');
		$(this).addClass('active');
    e.preventDefault();
    $('#login-errors').text('')
	});
	$('#register-form-link').click(function(e) {
		$("#register-form").delay(100).fadeIn(100);
 		$("#login-form").fadeOut(100);
		$('#login-form-link').removeClass('active');
		$(this).addClass('active');
    e.preventDefault();
    $('#login-errors').text('')
	});

});
function logIn() {
	
    var src = $("#login-form").serializeArray()
    var data = {}
    src.forEach((item) => {
      data[item.name] = item.value
    })
		if (validateLogin(data)) {
		$('#login-errors').text('')
    $.ajax({ url: '/sessions',
             type: 'POST',
             data: data,
             success: function(result){
               if(result.error){
                $('#login-errors').text(result.error)
               }
             }
	  });
	} else {
		$('#login-errors').text('icorrect email or password')
	}
}
function Register() {
	
  var src = $("#register-form").serializeArray()
  var data = {}
  src.forEach((item) => {
    data[item.name] = item.value
	})
  if (validateRegister(data)) {
		$('#login-errors').text('')
    $.ajax({ url: '/users',
           type: 'POST',
           data: {user: data},
           success: function(result){
            if(result.message){
              $('#login-errors').text(result.message)
             }
             if(result.error){
              $('#login-errors').text(result.error)
             }
           }
		});
	} else {
		$('#login-errors').text('incorrect email or password(must be at least 6 chars) or first/last name (must be at least 4 chars)')
	}
}

function validateLogin(data) {
	var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
  return ((data.password.length > 5) && re.test(String(data.email).toLowerCase()))
}

function validateRegister(data) {
	var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
  return ((data.password.length > 5) && re.test(String(data.email).toLowerCase()) && (data.first_name.length > 3) && (data.last_name.length > 3))
}
</script>